{% load cache %}
{% load lazysignup_tags %}

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>{% block title %}Archfinch{% endblock %}</title>
    <link rel="stylesheet" href="/media/style.css" />
    <link rel="image_src" href="/media/logo70.png" />
    <meta content="en-us" http-equiv="Content-Language" />
    <meta content="Archfinch - rate things you like or hate and get recommendations based on what you like." name="description" />
    {% if debug %}
        <script type="text/javascript" src="/adminmedia/js/jquery.min.js"></script>
    {% else %}
        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
    {% endif %}
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.4/jquery-ui.min.js"></script>
    <script type="text/javascript" src="/media/js/jquery.qtip-1.0.0-rc3.min.js"></script>
    <script type="text/javascript" src="/media/js/main.js"></script>
    {% block media %}{% endblock %}
    {% if not debug %}
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-17830334-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
    {% endif %}
</head>
<body>
<div id="wrap">
    <div id="logo">
        <a href="/" alt="Archfinch" title="Archfinch"><img src="/media/logo.png"></a>
        {% if debug %}<span style="font-size: 16px; color: #ffffff; background-color: #ff0000; padding: 2px 10px;">[ debug mode ]</span>{% endif %}
    </div>
    <div id="topnav">
        <ul class="menu">
            {% if user.is_authenticated %}
            <span id="menu_loggedin">
            <li> <a href="{% url logout %}" id="menu_logout">logout</a>
            <li> <a href="{% url users.views.overview user.username %}" id="menu_user">{% if user|is_lazy_user %}<i>you</i>{% else %}{{ user }}{% endif %}</a>
            </span>
            {% else %}
            <span id="menu_notloggedin">
            <li> <a href="/" id="menu_signup">signup</a>
            <li> <a href="{% url login %}" id="menu_login">login</a>
            </span>
            {% endif %}
        </ul>
    </div>
    <div id="navbar">
        <ul class="menu">
            {% if user.is_authenticated %}
            <li> <a href="{% url recommend-slugged "links" %}">links</a>
                 <ul class="submenu" style='width: 75px'>
                    <li> <a href="{% url recommend-slugged "videos" %}">videos</a>
                    <li> <a href="{% url recommend-slugged "pics" %}">pics</a>
                    <li> <a href="{% url recommend-slugged "links" %}">other</a>
                 </ul>
            <li> <a href="{% url main.views.recommend %}">things you might like</a>
                 {% if user.categories %}
                 <ul class="submenu">
                    {% for category in user.categories %}
                    <li> <a href="{% url recommend-slugged category.slug %}">{{ category.element_plural }}</a>
                    {% endfor %}
                 </ul>
                 {% endif %}
            <li> <a>people</a>
                 <ul class="submenu" style='width: 125px'>
                    <li> <a href="{% url users.views.similar %}">similar</a>
                    <li> <a href="{% url top-users %}">top users</a>
                 </ul>
            <li> <a href="{% url lists-overview %}">lists</a>
            {% else %}
            <li style='border: 0'> &nbsp;
            {% endif %}
            <li style='border: 0'> <form style="display:inline; float:right" action="{% url search %}"><input type='text' id='search' name='q' {% if query %}value='{{ query }}'{% else %}value='Search for things...' onClick='this.value=""'{% endif %}></form>
        </ul>
    </div>
    
    {% block message %}
    {% if user|is_lazy_user %}
    <div id="message">
        <div class="messagecontent">
            <p>You've been logged in as a temporary user -- if you log out you can lose your data.</p>
            <p><a href="{% url lazysignup_convert %}">Save your data by creating a permanent account</a> (it takes less than a minute).</p>
            <p>Don't worry, you can try out the site just fine for now, but remember to save your data later.</p>
        </div>
        <div class="login"><p>Already have an account?<br /><a href="{% url login %}">Log in</a>.</p></div>
        <div style='clear: both'></div>
    </div>
    {% endif %}
    {% endblock %}

    <div id="content">
        {% block content %}{% endblock %}
    </div>
    <div class="clearfooter"></div>
</div>
<div id="footer">
        <a href="http://blog.archfinch.com/">blog</a>
        | irc.archfinch.com #archfinch
        | Drop us a line. We care <b>a lot</b>. <a href="mailto:luke@archfinch.com">luke@archfinch.com</a>
        | We're <a href="https://github.com/drx/archfinch">open source</a>
</div>
</body>
</html>
